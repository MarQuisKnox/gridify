$.fn.extend({imageLoaded:function(n){var i=$(this).find("img"),t=i.length;0==t&&n(),i.each(function(i,a){var a=new Image;a.onload=function(){t--,0==t&&n()},a.onerror=function(){t--,0==t&&n()},a.src=$(a).attr("src")})},gridify:function(n){var i=$(this),n=n||{},t=function(n){for(var i=0,t=1;t<n.length;t++)n[t]<n[i]&&(i=t);return i},a=function(){i.css("position","relative");var a=i.find(n.srcNode),e=((n.transition||"all 0.5s ease")+", height 0, width 0",i.innerWidth()),o=parseInt(n.margin||0),r=parseInt(n.max_width||n.width||220),s=Math.max(Math.floor(e/(r+o)),1),f=1==s?o/2:e%(r+o)/2,h=[];n.max_width&&(s=Math.ceil(e/(r+o)),r=(e-s*o-o)/s,f=o/2);for(var c=0;s>c;c++)h.push(0);a.each(function(i,a){var e=$(a),s=t(h);e.css({width:r,position:"absolute",margin:o/2,top:h[s]+o/2,left:(r+o)*s+f,transition:n.transition||"all 0.5s ease"}),h[s]+=e.innerHeight()+o})};if(i.imageLoaded(function(){}),n.resizable){var e=$(window).on("resize",function(){a()});i.on("remove",e.unbind)}}});