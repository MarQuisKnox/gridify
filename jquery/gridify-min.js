$.fn.extend({imageLoaded:function(i){var n=$(this).find("img"),t=n.length;0==t&&i(),n.each(function(n,e){var e=new Image;e.onload=function(){t--,0==t&&i()},e.onerror=function(){t--,0==t&&i()},e.src=$(e).attr("src")})},gridify:function(i){var n=$(this),i=i||{},t=function(i){for(var n=0,t=1;t<i.length;t++)i[t]<i[n]&&(n=t);return n},e=function(){n.css("position","relative");var e=n.find(i.srcNode),a=((i.transition||"all 0.5s ease")+", height 0, width 0",n.innerWidth()),o=parseInt(i.margin||0),r=parseInt(i.max_width||i.width||220),s=Math.max(Math.floor(a/(r+o)),1),h=1==s?o/2:a%(r+o)/2,d=[];i.max_width&&(s=Math.ceil(a/(r+o)),r=(a-s*o-o)/s,h=o/2);for(var f=0;s>f;f++)d.push(0);e.each(function(n,e){var a=$(e),s=t(d);a.css({width:r,position:"absolute",margin:o/2,top:d[s]+o/2,left:(r+o)*s+h,transition:i.transition||"all 0.5s ease"}),d[s]+=a.innerHeight()+o})};if(e(),n.imageLoaded(function(){setTimeout(e,200)}),i.resizable){var a=$(window).on("resize",function(){e(),i.max_width&&setTimeout(e,200)});n.on("remove",a.unbind)}}});