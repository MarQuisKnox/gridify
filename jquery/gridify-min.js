$.fn.extend({imageLoaded:function(i){var n=$(this).find("img"),a=n.length;0==a&&i(),n.each(function(n,t){var t=new Image;t.onload=function(){a--,0==a&&i()},t.onerror=function(){a--,0==a&&i()},t.src=$(t).attr("src")})},gridify:function(i){var n=$(this),i=i||{},a=function(){n.css("position","relative");var a=n.find(i.srcNode),t=((i.transition||"all 0.5s ease")+", height 0, width 0",n.innerWidth()),e=parseInt(i.margin||0),r=parseInt(i.max_width||i.width||220),o=Math.max(Math.floor(t/(r+e)),1),s=1==o?e/2:t%(r+e)/2,h=[];i.max_width&&(o=Math.ceil(t/(r+e)),r=(t-o*e-e)/o,s=e/2);for(var d=0;o>d;d++)h.push(0);a.each(function(n,a){var t=$(a),o=$.inArray(Math.min.apply(Math,h),h);t.css({width:r,position:"absolute",margin:e/2,top:h[o]+e/2,left:(r+e)*o+s,transition:i.transition||"all 0.5s ease"}),h[o]+=t.innerHeight()+e})};if(n.imageLoaded(a),i.resizable){var t=$(window).on("resize",a);n.on("remove",t.unbind)}}});