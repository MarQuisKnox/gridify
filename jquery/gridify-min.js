$.fn.extend({imagesLoaded:function(n){var i=$(this).find("img"),t=count=i.length;0==count&&n();for(var o=0;t>o;o++){var r=new Image;r.onload=function(){count--,0==count&&n()},r.onerror=function(){count--,0==count&&n()},r.src=i[o].src}},gridify:function(n){var i=$(this),n=n||{},t=function(n){for(var i=0,t=1,o=n.length;o>t;t++)n[t]<n[i]&&(i=t);return i},o=function(){i.css("position","relative");var o=i.find(n.srcNode),r=(n.transition||"all 0.5s ease")+", height 0, width 0",a=i.innerWidth(),e=parseInt(n.margin||0),s=parseInt(n.max_width||n.width||220),c=Math.max(Math.floor(a/(s+e)),1),d=1==c?e/2:a%(s+e)/2,h=[];n.max_width&&(c=Math.ceil(a/(s+e)),s=(a-c*e-e)/c,d=e/2);for(var f=0;c>f;f++)h.push(0);for(var f=0,u=o.length;u>f;f++){var g=$(o[f]),l=t(h);g.css({width:s,position:"absolute",margin:e/2,top:h[l]+e/2,left:(s+e)*l+d,transition:r}),h[l]+=g.innerHeight()+e}};if(i.imagesLoaded(o),n.resizable){var r=$(window).on("resize",o);i.on("remove",r.unbind)}}});