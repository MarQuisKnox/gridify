Element.prototype.imageLoaded=function(e){for(var t=this.querySelectorAll("img"),n=t.length,i=0,o=t.length;o>i;i++){var r=new Image;r.onload=function(){n--,0==n&&e()},r.onerror=function(){n--,0==n&&e()},r.src=t[i].getAttribute("src")}},Element.prototype.gridify=function(e){var t=this,e=e||{},n=function(){t.style.position="relative";var n=t.querySelectorAll(e.srcNode),i=t.clientWidth,o=parseInt(e.margin||0),r=parseInt(e.max_width||e.width||220),a=Math.floor(i/(r+o)),d=(i%(r+o)-o)/2,s=[];e.max_width&&(r=(i-a*o-o)/a,d=o/2);for(var l=0;a>l;l++)s.push(0);for(var l=0,w=n.length;w>l;l++){var h=s.indexOf(Math.min.apply(Math,s));n[l].setAttribute("style","width: "+r+"px; position: absolute; margin: "+o/2+"px; top: "+(s[h]+o/2)+"px; left: "+((r+o)*h+d)+"px; transition: "+(e.transition||"all 0.5s ease")),s[h]+=n[l].clientHeight+o}};this.imageLoaded(n),e.resizable&&(window.attachEvent?window.attachEvent("onresize",n):window.addEventListener&&window.addEventListener("resize",n,!0),t.addEventListener("DOMNodeRemoved",function(){window.detachEvent?window.detachEvent("onresize",n):window.removeEventListener&&window.removeEventListener("resize",n)}))};